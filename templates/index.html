<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>个人记账报销系统</title>
    <link href="/static/css/bootstrap.min.css" rel="stylesheet">
    <link href="/static/css/bootstrap-icons.css" rel="stylesheet">
    <link href="/static/css/style.css" rel="stylesheet">
</head>

<body>
    <!-- 导航栏 -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
        <div class="container">
            <a class="navbar-brand" href="#">
                <i class="bi bi-wallet2"></i>
                记账报销系统
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="#" data-page="dashboard">
                            <i class="bi bi-house"></i> 首页
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" data-page="accounts">
                            <i class="bi bi-credit-card"></i> 账户管理
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" data-page="expenses">
                            <i class="bi bi-receipt"></i> 收支记录
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" data-page="reimbursements">
                            <i class="bi bi-file-earmark-text"></i> 报销管理
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" data-page="statistics">
                            <i class="bi bi-graph-up"></i> 统计分析
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" data-page="categories">
                            <i class="bi bi-tags"></i> 分类管理
                        </a>
                    </li>
                </ul>
                <ul class="navbar-nav">
                    <li class="nav-item" id="userInfo" style="display: none;">
                        <span class="navbar-text me-3">
                            <i class="bi bi-person-circle"></i>
                            <span id="userName"></span>
                        </span>
                    </li>
                    <li class="nav-item" id="profileBtn" style="display: none;">
                        <a class="nav-link" href="#" data-page="profile">
                            <i class="bi bi-person"></i> 个人信息
                        </a>
                    </li>
                    <li class="nav-item" id="logoutBtnNav" style="display: none;">
                        <a class="nav-link" href="#" id="logoutBtn">
                            <i class="bi bi-box-arrow-right"></i> 退出登录
                        </a>
                    </li>
                    <li class="nav-item" id="loginBtn">
                        <a class="nav-link" href="#" data-page="login">
                            <i class="bi bi-box-arrow-in-right"></i> 登录
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- 主要内容区域 -->
    <div class="container-fluid mt-3">


        <div id="app">
            <!-- 登录页面 -->
            <div id="loginPage" class="page">
                <div class="row justify-content-center">
                    <div class="col-md-6 col-lg-4">
                        <div class="card">
                            <div class="card-header text-center">
                                <h4><i class="bi bi-wallet2"></i> 用户登录</h4>
                            </div>
                            <div class="card-body">
                                <form id="loginForm">
                                    <div class="mb-3">
                                        <label for="loginUsername" class="form-label">用户名/邮箱</label>
                                        <input type="text" class="form-control" id="loginUsername" required>
                                    </div>
                                    <div class="mb-3">
                                        <label for="loginPassword" class="form-label">密码</label>
                                        <input type="password" class="form-control" id="loginPassword" required>
                                    </div>
                                    <button type="submit" class="btn btn-primary w-100">登录</button>
                                </form>
                                <div class="text-center mt-3">
                                    <a href="#" id="showRegister">还没有账户？立即注册</a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 注册页面 -->
            <div id="registerPage" class="page" style="display: none;">
                <div class="row justify-content-center">
                    <div class="col-md-6 col-lg-4">
                        <div class="card">
                            <div class="card-header text-center">
                                <h4><i class="bi bi-person-plus"></i> 用户注册</h4>
                            </div>
                            <div class="card-body">
                                <form id="registerForm">
                                    <div class="mb-3">
                                        <label for="registerName" class="form-label">姓名</label>
                                        <input type="text" class="form-control" id="registerName" required>
                                    </div>
                                    <div class="mb-3">
                                        <label for="registerUsername" class="form-label">用户名</label>
                                        <input type="text" class="form-control" id="registerUsername" required>
                                    </div>
                                    <div class="mb-3">
                                        <label for="registerEmail" class="form-label">邮箱</label>
                                        <input type="email" class="form-control" id="registerEmail" required>
                                    </div>
                                    <div class="mb-3">
                                        <label for="registerPassword" class="form-label">密码</label>
                                        <input type="password" class="form-control" id="registerPassword" required>
                                    </div>
                                    <div class="mb-3">
                                        <label for="confirmPassword" class="form-label">确认密码</label>
                                        <input type="password" class="form-control" id="confirmPassword" required>
                                    </div>
                                    <button type="submit" class="btn btn-primary w-100">注册</button>
                                </form>
                                <div class="text-center mt-3">
                                    <a href="#" id="showLogin">已有账户？立即登录</a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 仪表板页面 -->
            <div id="dashboardPage" class="page" style="display: none;">
                <div class="row">
                    <div class="col-12">
                        <h2><i class="bi bi-house"></i> 仪表板</h2>
                    </div>
                </div>

                <!-- 统计卡片 -->
                <div class="row mb-4">
                    <div class="col-md-3 mb-3">
                        <div class="card bg-primary text-white">
                            <div class="card-body">
                                <div class="d-flex justify-content-between">
                                    <div>
                                        <h6 class="card-title">总余额</h6>
                                        <h4 id="totalBalance">¥0.00</h4>
                                    </div>
                                    <div class="align-self-center">
                                        <i class="bi bi-wallet2 fs-1"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3 mb-3">
                        <div class="card bg-success text-white">
                            <div class="card-body">
                                <div class="d-flex justify-content-between">
                                    <div>
                                        <h6 class="card-title">本月收入</h6>
                                        <h4 id="monthlyIncome">¥0.00</h4>
                                    </div>
                                    <div class="align-self-center">
                                        <i class="bi bi-arrow-up-circle fs-1"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3 mb-3">
                        <div class="card bg-danger text-white">
                            <div class="card-body">
                                <div class="d-flex justify-content-between">
                                    <div>
                                        <h6 class="card-title">本月支出</h6>
                                        <h4 id="monthlyExpense">¥0.00</h4>
                                    </div>
                                    <div class="align-self-center">
                                        <i class="bi bi-arrow-down-circle fs-1"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3 mb-3">
                        <div class="card bg-info text-white">
                            <div class="card-body">
                                <div class="d-flex justify-content-between">
                                    <div>
                                        <h6 class="card-title">待审核报销</h6>
                                        <h4 id="pendingReimbursements">0</h4>
                                    </div>
                                    <div class="align-self-center">
                                        <i class="bi bi-file-earmark-text fs-1"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 快速操作 -->
                <div class="row mb-4">
                    <div class="col-12">
                        <div class="card">
                            <div class="card-header">
                                <h5><i class="bi bi-lightning"></i> 快速操作</h5>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-3 mb-2">
                                        <button class="btn btn-outline-primary w-100" data-page="expenses"
                                            data-action="add">
                                            <i class="bi bi-plus-circle"></i> 添加支出
                                        </button>
                                    </div>
                                    <div class="col-md-3 mb-2">
                                        <button class="btn btn-outline-success w-100" data-page="expenses"
                                            data-action="add-income">
                                            <i class="bi bi-plus-circle"></i> 添加收入
                                        </button>
                                    </div>
                                    <div class="col-md-3 mb-2">
                                        <button class="btn btn-outline-info w-100" data-page="accounts"
                                            data-action="add">
                                            <i class="bi bi-credit-card"></i> 添加账户
                                        </button>
                                    </div>
                                    <div class="col-md-3 mb-2">
                                        <button class="btn btn-outline-warning w-100" data-page="reimbursements"
                                            data-action="add">
                                            <i class="bi bi-file-earmark-plus"></i> 申请报销
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 最近交易 -->
                <div class="row">
                    <div class="col-md-8">
                        <div class="card">
                            <div class="card-header d-flex justify-content-between align-items-center">
                                <h5><i class="bi bi-clock-history"></i> 最近交易</h5>
                                <a href="#" class="btn btn-sm btn-outline-primary" data-page="expenses">查看全部</a>
                            </div>
                            <div class="card-body">
                                <div id="recentTransactions">
                                    <div class="text-center text-muted">
                                        <i class="bi bi-hourglass-split"></i> 加载中...
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="card">
                            <div class="card-header">
                                <h5><i class="bi bi-pie-chart"></i> 本月支出分类</h5>
                            </div>
                            <div class="card-body">
                                <canvas id="categoryChart" width="300" height="300"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 账户管理页面 -->
            <div id="accountsPage" class="page" style="display: none;">
                <div class="d-flex justify-content-between align-items-center mb-4">
                    <h2><i class="bi bi-credit-card"></i> 账户管理</h2>
                    <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#addAccountModal">
                        <i class="bi bi-plus-circle"></i> 添加账户
                    </button>
                </div>

                <!-- 账户统计卡片 -->
                <div class="row mb-4">
                    <div class="col-md-4">
                        <div class="card bg-primary text-white">
                            <div class="card-body">
                                <h6>总余额</h6>
                                <h4 id="accountsTotalBalance">¥0.00</h4>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="card bg-success text-white">
                            <div class="card-body">
                                <h6>账户数量</h6>
                                <h4 id="accountsCount">0</h4>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="card bg-info text-white">
                            <div class="card-body">
                                <h6>活跃账户</h6>
                                <h4 id="activeAccountsCount">0</h4>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 账户列表 -->
                <div class="card">
                    <div class="card-header">
                        <h5><i class="bi bi-list"></i> 账户列表</h5>
                    </div>
                    <div class="card-body">
                        <div id="accountsList">
                            <div class="text-center text-muted py-4">
                                <i class="bi bi-hourglass-split"></i> 加载中...
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 收支记录页面 -->
            <div id="expensesPage" class="page" style="display: none;">
                <div class="d-flex justify-content-between align-items-center mb-4">
                    <h2><i class="bi bi-receipt"></i> 收支记录</h2>
                    <div>
                        <button class="btn btn-success me-2" data-bs-toggle="modal" data-bs-target="#addExpenseModal"
                            data-type="income">
                            <i class="bi bi-plus-circle"></i> 添加收入
                        </button>
                        <button class="btn btn-danger" data-bs-toggle="modal" data-bs-target="#addExpenseModal"
                            data-type="expense">
                            <i class="bi bi-dash-circle"></i> 添加支出
                        </button>
                    </div>
                </div>

                <!-- 筛选器 -->
                <div class="card mb-4">
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-3">
                                <label class="form-label">类型</label>
                                <select class="form-select" id="expenseTypeFilter">
                                    <option value="">全部</option>
                                    <option value="income">收入</option>
                                    <option value="expense">支出</option>
                                </select>
                            </div>
                            <div class="col-md-3">
                                <label class="form-label">分类</label>
                                <select class="form-select" id="expenseCategoryFilter">
                                    <option value="">全部分类</option>
                                </select>
                            </div>
                            <div class="col-md-3">
                                <label class="form-label">开始日期</label>
                                <input type="date" class="form-control" id="expenseStartDate">
                            </div>
                            <div class="col-md-3">
                                <label class="form-label">结束日期</label>
                                <input type="date" class="form-control" id="expenseEndDate">
                            </div>
                        </div>
                        <div class="row mt-3">
                            <div class="col-12">
                                <button class="btn btn-primary" id="applyExpenseFilter">
                                    <i class="bi bi-funnel"></i> 应用筛选
                                </button>
                                <button class="btn btn-outline-secondary" id="resetExpenseFilter">
                                    <i class="bi bi-arrow-clockwise"></i> 重置
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 收支列表 -->
                <div class="card">
                    <div class="card-header">
                        <h5><i class="bi bi-list"></i> 收支记录</h5>
                    </div>
                    <div class="card-body">
                        <div id="expensesList">
                            <div class="text-center text-muted py-4">
                                <i class="bi bi-hourglass-split"></i> 加载中...
                            </div>
                        </div>
                        <nav id="expensesPagination" class="mt-3"></nav>
                    </div>
                </div>
            </div>

            <!-- 报销管理页面 -->
            <div id="reimbursementsPage" class="page" style="display: none;">
                <div class="d-flex justify-content-between align-items-center mb-4">
                    <h2><i class="bi bi-file-earmark-text"></i> 报销管理</h2>
                    <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#addReimbursementModal">
                        <i class="bi bi-plus-circle"></i> 申请报销
                    </button>
                </div>

                <!-- 报销统计卡片 -->
                <div class="row mb-4">
                    <div class="col-md-3">
                        <div class="card bg-warning text-white">
                            <div class="card-body">
                                <h6>待审核</h6>
                                <h4 id="pendingReimbursementsCount">0</h4>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="card bg-success text-white">
                            <div class="card-body">
                                <h6>已批准</h6>
                                <h4 id="approvedReimbursementsCount">0</h4>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="card bg-danger text-white">
                            <div class="card-body">
                                <h6>已拒绝</h6>
                                <h4 id="rejectedReimbursementsCount">0</h4>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="card bg-info text-white">
                            <div class="card-body">
                                <h6>总金额</h6>
                                <h4 id="totalReimbursementAmount">¥0.00</h4>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 筛选器 -->
                <div class="card mb-4">
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-4">
                                <label class="form-label">状态</label>
                                <select class="form-select" id="reimbursementStatusFilter">
                                    <option value="">全部状态</option>
                                    <option value="pending">待审核</option>
                                    <option value="approved">已批准</option>
                                    <option value="rejected">已拒绝</option>
                                </select>
                            </div>
                            <div class="col-md-4">
                                <label class="form-label">开始日期</label>
                                <input type="date" class="form-control" id="reimbursementStartDate">
                            </div>
                            <div class="col-md-4">
                                <label class="form-label">结束日期</label>
                                <input type="date" class="form-control" id="reimbursementEndDate">
                            </div>
                        </div>
                        <div class="row mt-3">
                            <div class="col-12">
                                <button class="btn btn-primary" id="applyReimbursementFilter">
                                    <i class="bi bi-funnel"></i> 应用筛选
                                </button>
                                <button class="btn btn-outline-secondary" id="resetReimbursementFilter">
                                    <i class="bi bi-arrow-clockwise"></i> 重置
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 报销列表 -->
                <div class="card">
                    <div class="card-header">
                        <h5><i class="bi bi-list"></i> 报销记录</h5>
                    </div>
                    <div class="card-body">
                        <div id="reimbursementsList">
                            <div class="text-center text-muted py-4">
                                <i class="bi bi-hourglass-split"></i> 加载中...
                            </div>
                        </div>
                        <nav id="reimbursementsPagination" class="mt-3"></nav>
                    </div>
                </div>
            </div>

            <!-- 统计分析页面 -->
            <div id="statisticsPage" class="page" style="display: none;">
                <div class="d-flex justify-content-between align-items-center mb-4">
                    <h2><i class="bi bi-graph-up"></i> 统计分析</h2>
                    <div>
                        <select class="form-select" id="statisticsPeriod" style="width: auto; display: inline-block;">
                            <option value="week">本周</option>
                            <option value="month" selected>本月</option>
                            <option value="quarter">本季度</option>
                            <option value="year">本年</option>
                        </select>
                    </div>
                </div>

                <!-- 统计概览 -->
                <div class="row mb-4">
                    <div class="col-md-3">
                        <div class="card bg-primary text-white">
                            <div class="card-body">
                                <h6>总收入</h6>
                                <h4 id="statsTotalIncome">¥0.00</h4>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="card bg-danger text-white">
                            <div class="card-body">
                                <h6>总支出</h6>
                                <h4 id="statsTotalExpense">¥0.00</h4>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="card bg-success text-white">
                            <div class="card-body">
                                <h6>净收入</h6>
                                <h4 id="statsNetIncome">¥0.00</h4>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="card bg-info text-white">
                            <div class="card-body">
                                <h6>交易笔数</h6>
                                <h4 id="statsTransactionCount">0</h4>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 图表区域 -->
                <div class="row">
                    <div class="col-md-6 mb-4">
                        <div class="card">
                            <div class="card-header">
                                <h5><i class="bi bi-pie-chart"></i> 支出分类分析</h5>
                            </div>
                            <div class="card-body">
                                <div id="expenseCategoryChart" class="chart-container">
                                    <div class="text-center text-muted py-4">
                                        <i class="bi bi-hourglass-split"></i> 加载中...
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6 mb-4">
                        <div class="card">
                            <div class="card-header">
                                <h5><i class="bi bi-bar-chart"></i> 收支趋势</h5>
                            </div>
                            <div class="card-body">
                                <div id="trendChart" class="chart-container">
                                    <div class="text-center text-muted py-4">
                                        <i class="bi bi-hourglass-split"></i> 加载中...
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 详细分析 -->
                <div class="row">
                    <div class="col-md-6">
                        <div class="card">
                            <div class="card-header">
                                <h5><i class="bi bi-list-ol"></i> 支出排行</h5>
                            </div>
                            <div class="card-body">
                                <div id="expenseRanking">
                                    <div class="text-center text-muted py-4">
                                        <i class="bi bi-hourglass-split"></i> 加载中...
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="card">
                            <div class="card-header">
                                <h5><i class="bi bi-calendar3"></i> 月度汇总</h5>
                            </div>
                            <div class="card-body">
                                <div id="monthlySummary">
                                    <div class="text-center text-muted py-4">
                                        <i class="bi bi-hourglass-split"></i> 加载中...
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 个人信息页面 -->
            <div id="profilePage" class="page" style="display: none;">
                <div class="d-flex justify-content-between align-items-center mb-4">
                    <h2><i class="bi bi-person-circle"></i> 个人信息</h2>
                    <button class="btn btn-primary" id="editProfileBtn">
                        <i class="bi bi-pencil"></i> 编辑信息
                    </button>
                </div>

                <!-- 用户信息卡片 -->
                <div class="row">
                    <div class="col-md-8">
                        <div class="card">
                            <div class="card-header">
                                <h5 class="mb-0"><i class="bi bi-person"></i> 基本信息</h5>
                            </div>
                            <div class="card-body">
                                <div class="row mb-3">
                                    <div class="col-sm-3">
                                        <strong>姓名:</strong>
                                    </div>
                                    <div class="col-sm-9" id="profileName">
                                        -
                                    </div>
                                </div>
                                <div class="row mb-3">
                                    <div class="col-sm-3">
                                        <strong>用户名:</strong>
                                    </div>
                                    <div class="col-sm-9" id="profileUsername">
                                        -
                                    </div>
                                </div>
                                <div class="row mb-3">
                                    <div class="col-sm-3">
                                        <strong>邮箱:</strong>
                                    </div>
                                    <div class="col-sm-9" id="profileEmail">
                                        -
                                    </div>
                                </div>
                                <div class="row mb-3">
                                    <div class="col-sm-3">
                                        <strong>注册时间:</strong>
                                    </div>
                                    <div class="col-sm-9" id="profileCreatedAt">
                                        -
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="col-md-4">
                        <div class="card">
                            <div class="card-header">
                                <h5 class="mb-0"><i class="bi bi-shield-check"></i> 安全设置</h5>
                            </div>
                            <div class="card-body">
                                <button class="btn btn-outline-warning btn-sm mb-2 w-100" id="changePasswordBtn">
                                    <i class="bi bi-key"></i> 修改密码
                                </button>
                                <button class="btn btn-outline-danger btn-sm w-100" id="logoutAllBtn">
                                    <i class="bi bi-box-arrow-right"></i> 退出所有设备
                                </button>
                            </div>
                        </div>

                        <div class="card mt-3">
                            <div class="card-header">
                                <h5 class="mb-0"><i class="bi bi-bar-chart"></i> 使用统计</h5>
                            </div>
                            <div class="card-body">
                                <div class="d-flex justify-content-between mb-2">
                                    <span>账户数量:</span>
                                    <span id="profileAccountCount">0</span>
                                </div>
                                <div class="d-flex justify-content-between mb-2">
                                    <span>交易记录:</span>
                                    <span id="profileTransactionCount">0</span>
                                </div>
                                <div class="d-flex justify-content-between">
                                    <span>报销申请:</span>
                                    <span id="profileReimbursementCount">0</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 分类管理页面 -->
            <div id="categoriesPage" class="page" style="display: none;">
                <div class="d-flex justify-content-between align-items-center mb-4">
                    <h2><i class="bi bi-tags"></i> 分类管理</h2>
                    <div>
                        <button class="btn btn-outline-secondary me-2" onclick="CategoryManager.initDefaultCategories()">
                            <i class="bi bi-arrow-clockwise"></i> 初始化默认分类
                        </button>
                        <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#categoryModal" onclick="document.getElementById('categoryModalTitle').textContent='添加分类';document.getElementById('categoryForm').reset();document.getElementById('categoryId').value=''">
                            <i class="bi bi-plus"></i> 添加分类
                        </button>
                    </div>
                </div>

                <!-- 分类列表 -->
                <div class="card">
                    <div class="card-header">
                        <h5 class="mb-0"><i class="bi bi-list"></i> 分类列表</h5>
                    </div>
                    <div class="card-body">
                        <div id="categoryList" class="list-group">
                            <div class="text-center text-muted py-4">
                                <i class="bi bi-hourglass-split"></i> 加载中...
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Toast 通知容器 -->
    <div class="toast-container position-fixed bottom-0 end-0 p-3">
        <div id="toast" class="toast" role="alert">
            <div class="toast-header">
                <strong class="me-auto" id="toastTitle">通知</strong>
                <button type="button" class="btn-close" data-bs-dismiss="toast"></button>
            </div>
            <div class="toast-body" id="toastBody">
                消息内容
            </div>
        </div>
    </div>

    <!-- 加载遮罩 -->
    <div id="loadingOverlay" class="loading-overlay" style="display: none;">
        <div class="spinner-border text-primary" role="status">
            <span class="visually-hidden">加载中...</span>
        </div>
    </div>

    <!-- 添加账户模态框 -->
    <div class="modal fade" id="addAccountModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title"><i class="bi bi-credit-card"></i> 添加账户</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="addAccountForm">
                        <div class="mb-3">
                            <label class="form-label">账户名称</label>
                            <input type="text" class="form-control" name="account_name" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">账户类型</label>
                            <select class="form-select" name="account_type" required>
                                <option value="">请选择账户类型</option>
                                <option value="cash">现金</option>
                                <option value="bank">银行卡</option>
                                <option value="credit_card">信用卡</option>
                                <option value="alipay">支付宝</option>
                                <option value="wechat">微信支付</option>
                                <option value="other">其他</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">初始余额</label>
                            <input type="number" class="form-control" name="balance" step="0.01" value="0" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">描述</label>
                            <textarea class="form-control" name="description" rows="3"></textarea>
                        </div>
                        <div class="mb-3" id="reimbursableOption" style="display: none;">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" name="is_reimbursable" id="isReimbursable">
                                <label class="form-check-label" for="isReimbursable">
                                    可申请报销
                                </label>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">取消</button>
                    <button type="button" class="btn btn-primary" id="saveAccountBtn">保存</button>
                </div>
            </div>
        </div>
    </div>

    <!-- 编辑账户模态框 -->
    <div class="modal fade" id="editAccountModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title"><i class="bi bi-pencil-square"></i> 编辑账户</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="editAccountForm">
                        <input type="hidden" id="editAccountId" name="id">
                        <div class="mb-3">
                            <label class="form-label">账户名称</label>
                            <input type="text" class="form-control" id="editAccountName" name="account_name" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">账户类型</label>
                            <select class="form-select" id="editAccountType" name="account_type" required>
                                <option value="">请选择账户类型</option>
                                <option value="cash">现金</option>
                                <option value="bank">银行卡</option>
                                <option value="credit_card">信用卡</option>
                                <option value="alipay">支付宝</option>
                                <option value="wechat">微信支付</option>
                                <option value="other">其他</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">余额</label>
                            <input type="number" class="form-control" id="editAccountBalance" name="balance" step="0.01"
                                required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">描述</label>
                            <textarea class="form-control" id="editAccountDescription" name="description"
                                rows="3"></textarea>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">取消</button>
                    <button type="button" class="btn btn-primary" id="updateAccountBtn">更新</button>
                </div>
            </div>
        </div>
    </div>

    <!-- 添加收支记录模态框 -->
    <div class="modal fade" id="addExpenseModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title"><i class="bi bi-receipt"></i> <span id="expenseModalTitle">添加收支记录</span>
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="addExpenseForm">
                        <input type="hidden" name="expense_type" id="expenseType" value="expense">
                        <div class="mb-3">
                            <label class="form-label">金额</label>
                            <input type="number" class="form-control" name="amount" step="0.01" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">分类</label>
                            <select class="form-select" name="category" id="expenseCategory" required>
                                <option value="">请选择分类</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">账户</label>
                            <select class="form-select" name="account_id" id="expenseAccount" required>
                                <option value="">请选择账户</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">日期</label>
                            <input type="date" class="form-control" name="expense_date" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">描述</label>
                            <textarea class="form-control" name="description" rows="3"></textarea>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">取消</button>
                    <button type="button" class="btn btn-primary" id="saveExpenseBtn">保存</button>
                </div>
            </div>
        </div>
    </div>

    <!-- 添加报销申请模态框 -->
    <div class="modal fade" id="addReimbursementModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title"><i class="bi bi-file-earmark-plus"></i> 申请报销</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="addReimbursementForm">
                        <div class="mb-3">
                            <label class="form-label">报销标题</label>
                            <input type="text" class="form-control" name="title" placeholder="请输入报销标题" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">选择支出记录</label>
                            <select class="form-select" name="expense_ids" id="reimbursementExpense" required>
                                <option value="">请选择支出记录</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">报销金额</label>
                            <input type="number" class="form-control" name="amount" step="0.01" readonly>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">申请说明</label>
                            <textarea class="form-control" name="description" rows="3" placeholder="请输入申请说明"></textarea>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">取消</button>
                    <button type="button" class="btn btn-primary" id="saveReimbursementBtn">提交申请</button>
                </div>
            </div>
        </div>
    </div>

    <!-- 编辑个人信息模态框 -->
    <div class="modal fade" id="editProfileModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title"><i class="bi bi-person-gear"></i> 编辑个人信息</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="editProfileForm">
                        <div class="mb-3">
                            <label class="form-label">姓名</label>
                            <input type="text" class="form-control" name="name" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">邮箱</label>
                            <input type="email" class="form-control" name="email" required>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">取消</button>
                    <button type="button" class="btn btn-primary" id="saveProfileBtn">保存</button>
                </div>
            </div>
        </div>
    </div>

    <!-- 编辑收支记录模态框 -->
    <div class="modal fade" id="editExpenseModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="editExpenseModalTitle"><i class="bi bi-pencil-square"></i> 编辑收支记录</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="editExpenseForm">
                        <input type="hidden" id="editExpenseId" name="id">
                        <div class="mb-3">
                            <label class="form-label">类型</label>
                            <select class="form-select" id="editExpenseType" name="expense_type" required>
                                <option value="income">收入</option>
                                <option value="expense">支出</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">金额</label>
                            <input type="number" class="form-control" id="editExpenseAmount" name="amount" step="0.01"
                                min="0" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">类别</label>
                            <select class="form-select" id="editExpenseCategory" name="category" required>
                                <!-- 动态加载 -->
                            </select>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">账户</label>
                            <select class="form-select" id="editExpenseAccount" name="account_id" required>
                                <!-- 动态加载 -->
                            </select>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">日期</label>
                            <input type="date" class="form-control" id="editExpenseDate" name="expense_date" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">描述</label>
                            <textarea class="form-control" id="editExpenseDescription" name="description"
                                rows="3"></textarea>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">取消</button>
                    <button type="button" class="btn btn-primary" id="updateExpenseBtn">更新</button>
                </div>
            </div>
        </div>
    </div>

    <!-- 编辑报销申请模态框 -->
    <div class="modal fade" id="editReimbursementModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title"><i class="bi bi-pencil-square"></i> 编辑报销申请</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="editReimbursementForm">
                        <input type="hidden" id="editReimbursementId" name="id">
                        <div class="mb-3">
                            <label class="form-label">标题</label>
                            <input type="text" class="form-control" id="editReimbursementTitle" name="title" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">描述</label>
                            <textarea class="form-control" id="editReimbursementDescription" name="description"
                                rows="3"></textarea>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">取消</button>
                    <button type="button" class="btn btn-primary" id="updateReimbursementBtn">更新</button>
                </div>
            </div>
        </div>
    </div>

    <!-- 修改密码模态框 -->
    <div class="modal fade" id="changePasswordModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title"><i class="bi bi-key"></i> 修改密码</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="changePasswordForm">
                        <div class="mb-3">
                            <label class="form-label">当前密码</label>
                            <input type="password" class="form-control" name="current_password" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">新密码</label>
                            <input type="password" class="form-control" name="new_password" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">确认新密码</label>
                            <input type="password" class="form-control" name="confirm_password" required>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">取消</button>
                    <button type="button" class="btn btn-primary" id="savePasswordBtn">修改密码</button>
                </div>
            </div>
        </div>
    </div>

    <!-- 分类管理模态框 -->
    <div class="modal fade" id="categoryModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title"><i class="bi bi-tags"></i> <span id="categoryModalTitle">添加分类</span></h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="categoryForm">
                        <input type="hidden" id="categoryId" name="id">
                        <div class="mb-3">
                            <label class="form-label">分类值</label>
                            <input type="text" class="form-control" id="categoryValue" name="value" required placeholder="例如: food">
                            <div class="form-text">用于系统内部识别的英文值</div>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">分类标签</label>
                            <input type="text" class="form-control" id="categoryLabel" name="label" required placeholder="例如: 餐饮">
                            <div class="form-text">显示给用户的中文标签</div>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">分类类型</label>
                            <select class="form-select" id="categoryType" name="category_type" required>
                                <option value="">请选择分类类型</option>
                                <option value="expense">支出</option>
                                <option value="income">收入</option>
                            </select>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">取消</button>
                    <button type="button" class="btn btn-primary" id="saveCategoryBtn">保存</button>
                </div>
            </div>
        </div>
    </div>

    <!-- JavaScript -->
    <script src="/static/js/bootstrap.bundle.min.js"></script>
    <script src="/static/js/chart.min.js"></script>
    <script src="/static/js/app.js"></script>
</body>

</html>